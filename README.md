# onlineEdu-realtime-analysis
first commit
# 3.3.实时统计注册人员信息
 用户使用网站或APP进行注册，后台实时收集数据传输Kafka，Spark Streaming进行对接统计，实时统计注册人数。
- 需求1：实时统计注册人数，批次为3秒一批，使用updateStateBykey算子计算历史数据和当前批次的数据总数，仅此需求使用updateStateBykey，后续需求不使用updateStateBykey。
- 需求2：每6秒统统计一次1分钟内的注册数据，不需要历史数据 提示:reduceByKeyAndWindow算子
- 需求3：观察对接数据，尝试进行调优。
# 3.4实时计算学员做题正确率与知识点掌握度
  用户在网站或APP进行做题，做完题点击交卷按钮，程序将做题记录提交，传输到Kafka中，下游Spark Streaming对接kafka实现实时计算做题正确率和掌握度，将正确率和掌握度存入mysql中，用户点击交卷后刷新页面能立马看到自己做题的详情。
 - 需求1：要求Spark Streaming 保证数据不丢失，每秒1000条处理速度，需要手动维护偏移量
 - 需求2：同一个用户做在同一门课程同一知识点下做题需要去重，并且需要记录去重后的做题id与个数。
 - 需求3：计算知识点正确率 正确率计算公式：做题正确总个数/做题总数 保留两位小数
 - 需求4：计算知识点掌握度 去重后的做题个数/当前知识点总题数（已知30题）*当前知识点的正确率
# 3.5实时统计商品页到订单页，订单页到支付页转换率
用户浏览课程首页点击下订单，跳转到订单页面，再点击支付跳转到支付页面进行支付，收集各页面跳转json数据，解析json数据计算各页面点击数和转换率，计算top3点击量按地区排名（ip字段，需要根据历史数据累计）
- 需求1：计算首页总浏览数、订单页总浏览数、支付页面总浏览数
- 需求2：计算商品课程页面到订单页的跳转转换率、订单页面到支付页面的跳转转换率
- 需求3：根据ip得出相应省份，展示出top3省份的点击数，需要根据历史数据累加
# 3.6实时统计学员播放视频各时长
用户在线播放视频进行学习课程，后台记录视频播放开始区间和结束区间，及播放开始时间和播放结束时间，后台手机数据传输kafka需要计算用户播放视频总时长、有效时长、完成时长，及各维度总播放时长。
- 需求1：计算各章节下的播放总时长(按chapterid聚合统计播放总时长)
- 需求2：计算各课件下的播放总时长(按cwareid聚合统计播放总时长)
- 需求3：计算各辅导下的播放总时长(按edutypeid聚合统计播放总时长)
- 需求4：计算各播放平台下的播放总时长(按sourcetype聚合统计播放总时长)
- 需求5：计算各科目下的播放总时长(按subjectid聚合统计播放总时长)
- 需求6：计算用户学习视频的播放总时长、有效时长、完成时长，需求记录视频播历史区间，对于用户多次学习的播放区间不累计有效时长和完成时长。
    
   播放总时长计算：(te-ts)/1000  向下取整  单位：秒
   完成时长计算： 根据pe-ps 计算 需要对历史数据进行去重处理
   有效时长计算：根据te-ts 除以pe-ts 先计算出播放每一区间需要的实际时长 * 完成时长
